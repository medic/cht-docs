---
title: "CHT CouchDB configuration"
linkTitle: "Configuration"
weight: 2
description: >
    CHT specific changes to default CouchDB configurations
keywords: config, configuration
---

Due to CHT particularities, several changes have been made to default CouchDB configuration. These changes are designed to improve performance, reliability, and to better support the CHT workflows. The configuration is bundled with the CouchDB Docker image and can be found in the [CHT repository](https://github.com/medic/cht-core/blob/master/couchdb/10-docker-default.ini).

For more information about CouchDB configuration options, see the [CouchDB documentation](https://docs.couchdb.org/en/stable/config/index.html).

{{< callout >}}
**Note:**
Some CHT configuration values are the same as the default CouchDB values. This is the intention and ensures when changes occur in CouchDB versions over time, the CHT still has the value it needs.
{{< /callout >}}

#### Configuration Field Explanations
| [Section] Field = value                                                                                     | Description                                                                               | Default value                                                                                                                                           |
|-------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|
| `[fabric]`<br>`request_timeout = infinity`                                                                  | Sets internal Cluster CouchDB request timeout in seconds.                                 | 60000. Not documented.                                                                                                                                  |
| `[query_server_config]`<br>`os_process_limit = 1000`                                                        | Sets the maximum number of OS processes that can be spawned by CouchDB.                   | [100](https://docs.couchdb.org/en/stable/config/query-servers.html#query_server_config/os_process_limit)                                                |
| `[couchdb]`<br>`os_process_timeout = 60000`                                                                 | Sets the maximum time in milliseconds that an OS process can run before being terminated. | [5000](https://docs.couchdb.org/en/stable/config/couchdb.html#couchdb/os_process_timeout)                                                               |
| `[couchdb]`<br>`max_dbs_open = 5000`                                                                        | Sets the maximum number of databases that can be open simultaneously.                     | [100](https://docs.couchdb.org/en/stable/config/couchdb.html#couchdb/max_dbs_open)                                                                      |
| `[couchdb]`<br>`attachment_stream_buffer_size = 16384`                                                      | Sets the size of the buffer used to stream attachments.                                   | [4096](https://docs.couchdb.org/en/stable/config/couchdb.html#couchdb/attachment_stream_buffer_size)                                                    |
| `[couchdb]`<br>`max_document_size = 4294967296`                                                             | Limit maximum document body size.                                                         | [8000000](https://docs.couchdb.org/en/stable/config/couchdb.html#couchdb/max_document_size)                                                             |
| `[couchdb]`<br>`changes_doc_ids_optimization_threshold = 40000`                                             | Change requests with docs ids optimization treshold.                                      | 100. Not documented.                                                                                                                                    |
| `[chttpd]`<br>`port = 5984`                                                                                 | Sets the port on which CouchDB listens for HTTP requests.                                 | [5984](https://docs.couchdb.org/en/stable/config/http.html#chttpd/port)                                                                                 |
| `[chttpd]`<br>`bind_address = 0.0.0.0`                                                                      | HTTP port IP address binding.                                                             | [127.0.0.1](https://docs.couchdb.org/en/stable/config/http.html#chttpd/bind_address)                                                                    |
| `[chttpd]`<br>`require_valid_user = true`                                                                   | Require authentication for all requests .                                                 | [false](https://docs.couchdb.org/en/stable/config/auth.html#chttpd/require_valid_user)                                                                  |
| `[httpd]`<br>`secure_rewrites = false`                                                                      | This option allow to isolate databases via subdomains.                                    | [true](https://docs.couchdb.org/en/stable/config/http.html#chttpd/secure_rewrites)                                                                      |
| `[httpd]`<br>`max_http_request_size = 4294967296`                                                           | Limit the maximum size of the HTTP request body.                                          | [4294967296](https://docs.couchdb.org/en/stable/config/http.html#chttpd/max_http_request_size)                                                          |
| `[httpd]`<br>`WWW-Authenticate = Basic realm="Medic Mobile Web Services"`                                   | Avoid base auth popups in the browser.                                                    |                                                                                                                                                         |
| `[couch_httpd_auth]`<br>`timeout = 31536000`                                                                | Number of seconds since the last request before sessions will be expired.                 | [600](https://docs.couchdb.org/en/stable/config/auth.html#chttpd_auth/timeout)                                                                          |
| `[couch_httpd_auth]`<br>`allow_persistent_cookies = true`                                                   | CouchDB will set the Max-Age and Expires attributes on the cookie.                        | [true](https://docs.couchdb.org/en/stable/config/auth.html#chttpd_auth/allow_persistent_cookies)                                                        |
| `[chttpd_auth_lockout]`<br>`mode = warn`                                                                    | Sets the authentication lockout mode.                                                     | [enforce](https://docs.couchdb.org/en/stable/config/auth.html#chttpd_auth_lockout)                                                                      |
| `[ssl]`<br>`verify_ssl_certificates = false`                                                                | Set to true to validate peer certificates.                                                | [false](https://docs.couchdb.org/en/stable/config/http.html#ssl/verify_ssl_certificates)                                                                |
| `[ssl]`<br>`ssl_certificate_max_depth = 4`                                                                  | Maximum peer certificate depth.                                                           | [1](https://docs.couchdb.org/en/stable/config/http.html#ssl/ssl_certificate_max_depth)                                                                  |
| `[cluster]`<br>`q = 12`                                                                                     | Sets the default number of shards for newly created databases.                            | [2](https://docs.couchdb.org/en/stable/config/cluster.html#cluster/q)                                                                                   |
| `[cluster]`<br>`n = 1`                                                                                      | Sets the number of replicas of each document in a cluster.                                | [3](https://docs.couchdb.org/en/stable/config/cluster.html#cluster/n)                                                                                   |
| `[attachments]`<br>`compressible_types = text/*, application/javascript, application/json, application/xml` | Sets which attachment MIME types will be compressed.                                      | [text/*, application/javascript, application/json, application/xml](https://docs.couchdb.org/en/stable/config/misc.html#attachments/compressible_types) |
| `[attachments]`<br>`compression_level = 8`                                                                  | Defines zlib compression level for the attachments.                                       | [8](https://docs.couchdb.org/en/stable/config/misc.html#attachments/compression_level)                                                                  |
| `[nouveau]`<br>`enable = true`                                                                              | Enables Nouveau.                                                                          | [false](https://docs.couchdb.org/en/stable/install/nouveau.html#enable-nouveau)                                                                         |
| `[nouveau]`<br>`url = http://nouveau:5987`                                                                  | Nouveau Server address.                                                                   | [Empty](https://docs.couchdb.org/en/stable/install/nouveau.html#configuring-couchdb-to-authenticate-to-nouveau)                                         |

